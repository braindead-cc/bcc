arch: amd64
image: freebsd/latest
sources:
        - https://git.sr.ht/~kiedtl/lbf.git
tasks:
        - dependencies: |
                sudo pkg update -f
                sudo pkg install meson scdoc tcl87
                sudo pkg install gcc pixz
        - prepare: |
                cd lbf
                meson build
        - build: |
                cd lbf
                ninja -C build
        - test: |
                cd lbf/tests
                ./test.tcl
        - artifacts: |
                cd lbf
                scripts/dist-src
                scripts/dist-bin
                mv lbf-*-bin.tar.xz lbf-bin.tar.xz
                mv lbf-*-src.tar.xz lbf-src.tar.xz
artifacts:
        - lbf/lbf-bin.tar.xz
        - lbf/lbf-src.tar.xz
